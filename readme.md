# Отток клиентов

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 

Постройте модель с предельно большим значением *F1*-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте *F1*-меру на тестовой выборке самостоятельно.

Дополнительно измеряйте *AUC-ROC*, сравнивайте её значение с *F1*-мерой.

Источник данных: [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

**Описание даннных**

**Признаки**

`RowNumber` — индекс строки в данных  
`CustomerId` — уникальный идентификатор клиента  
`Surname` — фамилия  
`CreditScore` — кредитный рейтинг  
`Geography` — страна проживания  
`Gender` — пол  
`Age` — возраст  
`Tenure` — сколько лет человек является клиентом банка  
`Balance` — баланс на счёте  
`NumOfProducts` — количество продуктов банка, используемых клиентом  
`HasCrCard` — наличие кредитной карты  
`IsActiveMember` — активность клиента  
`EstimatedSalary` — предполагаемая зарплата

**Целевой признак**

`Exited` — факт ухода клиента

**Общий вывод:**

Основной задачей проекта было построение модели оттока по уже готовой разметке.  
В рамках проекта:
- была сделана предобработка данных:
     - обработка пропусков
     - исключение лишних для обучения модели столбцов
     - проверка мультиколлениарности признаков
     - оценка дисбаланса целевой переменной
- далее был осуществлен первичный подход к обучению моделей логистической регрессии, решающего дерева и случайного леса, в каждом случае подбирались оптимальные гиперпараметры для увеличения метрики f1-score.
- после, для каждой из моделей, последовательно применялись различные подходы для борьбы с дисбалансом и улучшению качества моделей:
    - балансировка
    - upsampling
    - downsampling
- на завершающем этапе было проведено итоговое обучение и проверка метрик на тестовой выборке и определены лучшие комбинации `модель - способ` устранения дисбаланса. Интерессно, что для каждой модели лучше подходил свой метод корректировки.
- дополнительно для 3 типов моделей была пстроеа ROC - кривая и определена метрика AUC-ROC.
- лучший результат показала модель Random Forest. **F1-score - 0.61**, **roc_auc_score: 0.86**
